{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title></title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="Free HTML Templates" name="keywords">
    <meta content="Free HTML Templates" name="description">
    <style>
        .magnify {
  position: absolute;
transform: translate(-50%,-50%);
top: 50%;
left: 50%;
  display: inline-block;
}
.magnify .magnified {
  display: block;
  z-index: 10;
  margin: auto;
  width: 565px;
  height: 552px;
  border: 5px solid #fff;
}
.magnify .magnifier {
  height: 260px;
  width: 280px;
  position: absolute;
  z-index: 20;
  border: 4px solid white;
  background-size: 500%;
  background-repeat: no-repeat;
  margin-left: -100px !important;
  margin-top: -100px !important;
  pointer-events: none;
}
.magnifier {
    position: absolute;
    z-index: 9999; /* Adjust as necessary */
    width: 200px; /* Adjust width of magnifier */
    height: 200px; /* Adjust height of magnifier */
    background-repeat: no-repeat;
    background-size: 500% 500%; /* Adjust background-size for zoom effect */
    pointer-events: none; /* Ensure magnifier does not interfere with mouse events */
    display: none; /* Hide initially */
}

/* Container styling */
.container {
    max-width: 1200px;
    margin: 0 auto;
}

/* Row styling */
.row {
    display: flex;
    flex-wrap: wrap;
    margin: -15px; /* Adjust for the padding of columns */
}

/* Column styling */
.col {
    flex: 1 1 25%; /* 4 columns */
    padding: 15px;
    box-sizing: border-box;
}

.product-item {
    background-color: #f8f9fa;
    border: 1px solid #ddd;
    border-radius: 5px;
    overflow: hidden;
    text-align: center;
}

.product-img {
    position: relative;
    width: 100%;
    height: 250px; /* Fixed height for images */
    overflow: hidden;
}

.product-img img {
    width: 100%;
    height: 100%;
    object-fit: cover; /* Ensure the image covers the entire space */
}

.product-action {
    position: absolute;
    bottom: 10px;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    gap: 5px;
}

.product-action a {
    display: inline-block;
    padding: 5px 10px;
    background: rgba(255, 255, 255, 0.8);
    border: 1px solid #ddd;
    border-radius: 3px;
    color: #333;
}

.text-center {
    padding: 15px;
}

.text-truncate {
    display: inline-block;
    max-width: 100%;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.d-flex {
    display: flex;
    justify-content: center;
}

.align-items-center {
    align-items: center;
}

    </style>
</head>

<body>

    {% include 'common.html' %}

    <!-- Breadcrumb Start -->
    <div class="container-fluid">
        <div class="row px-xl-5">
            <div class="col-12">
                <nav class="breadcrumb bg-light mb-30">
                    <a class="breadcrumb-item text-dark" href="{% url 'userHome' %}">Home</a>
                    <a class="breadcrumb-item text-dark" href="{% url 'shop' %}">Shop</a>
                    <span class="breadcrumb-item active">Shop Detail</span>
                </nav>
            </div>
        </div>
    </div>
    <!-- Breadcrumb End -->


    <!-- Shop Detail Start -->
    <div class="container-fluid pb-5">
        <div class="row px-xl-5">
            <div class="col-lg-5 mb-30">
                <div id="product-carousel" class="carousel slide" data-ride="carousel">
                    <div class="carousel-inner bg-light ">
                        {% if product.images.all %}
                        {% for i in product.images.all  %}
                        <div class="carousel-item  {% if forloop.first %} active {% endif %}"  >
                            <div class="magnify">
                                <div class="magnifier" style="background-image:url({{ i.image.url }});"></div>
                                <div class="magnified">
                                   <!-- <img class="w-100 h-100" src="{{ i.image.url }}" > -->
                                </div>
                              </div>
                            <img class="w-100 h-100" src="{{ i.image.url }}" alt="Image">
                        </div>
                        {% endfor %}
                        {% endif %}
                    </div>
                      
                      <p class="output"></p>
                    <a class="carousel-control-prev" href="#product-carousel" data-slide="prev">
                        <i class="fa fa-2x fa-angle-left text-dark"></i>
                    </a>
                    <a class="carousel-control-next" href="#product-carousel" data-slide="next">
                        <i class="fa fa-2x fa-angle-right text-dark"></i>
                    </a>
                </div>
            </div>

            {% if product %}
<div class="col-lg-7 h-auto mb-30">
    <div class="h-100 bg-light p-30">
        <h3>{{ product.name }} <span><h6 id="stock-info"></h6></span></h3>
        <div class="d-flex mb-3">
            <div class="text-primary mr-2">
                <small class="fas fa-star"></small>
                <small class="fas fa-star"></small>
                <small class="fas fa-star"></small>
                <small class="fas fa-star-half-alt"></small>
                <small class="far fa-star"></small>
            </div>
            <small class="pt-1">(99 Reviews)</small>
        </div>
        <h3 class="font-weight-semi-bold mb-4" id="product-price"></h3>
        <p class="mb-4">{{ product.description }}</p>

        {% for variation in product.variation_set.all %}
        <div class="d-flex mb-3">
            <strong class="text-dark mr-3">{{ variation.name }}</strong>
            <form>
                {% for option in variation.variationoption_set.all %}
                <div class="custom-control custom-radio custom-control-inline">
                    <input type="radio" class="custom-control-input variation-option" id="{{ variation.name }}-{{ option.id }}" name="{{ variation.name }}" data-variation-id="{{ variation.id }}" data-variation-name="{{ variation.name }}" data-option-value="{{ option.value }}" value="{{ option.id }}" {% if forloop.first %}checked{% endif %}>
                    <label class="custom-control-label" for="{{ variation.name }}-{{ option.id }}">{{ option.value }}</label>
                </div>
                {% endfor %}
            </form>
        </div>
        {% endfor %}
        <h6 id="stock-info"></h6>

        <!-- <div class="d-flex mb-4">
                        <strong class="text-dark mr-3">Colors:</strong>
                        <form>
                            <div class="custom-control custom-radio custom-control-inline">
                                <input type="radio" class="custom-control-input" id="color-1" name="color">
                                <label class="custom-control-label" for="color-1">Black</label>
                            </div>
                            <div class="custom-control custom-radio custom-control-inline">
                                <input type="radio" class="custom-control-input" id="color-2" name="color">
                                <label class="custom-control-label" for="color-2">White</label>
                            </div>
                            <div class="custom-control custom-radio custom-control-inline">
                                <input type="radio" class="custom-control-input" id="color-3" name="color">
                                <label class="custom-control-label" for="color-3">Red</label>
                            </div>
                            <div class="custom-control custom-radio custom-control-inline">
                                <input type="radio" class="custom-control-input" id="color-4" name="color">
                                <label class="custom-control-label" for="color-4">Blue</label>
                            </div>
                            <div class="custom-control custom-radio custom-control-inline">
                                <input type="radio" class="custom-control-input" id="color-5" name="color">
                                <label class="custom-control-label" for="color-5">Green</label>
                            </div>
                        </form>
                    </div> -->

        <div class="d-flex align-items-center mb-4 pt-2">
            <div class="input-group quantity mr-3" style="width: 130px;">
                <div class="input-group-btn">
                    <button class="btn btn-primary btn-minus">
                        <i class="fa fa-minus"></i>
                    </button>
                </div>
                <input type="text" class="form-control bg-secondary border-0 text-center" value="1">
                <div class="input-group-btn">
                    <button class="btn btn-primary btn-plus">
                        <i class="fa fa-plus"></i>
                    </button>
                </div>
            </div>
            <button class="btn btn-primary px-3 add-to-cart-btn" data-product-id="{{ product.id }}" data-configuration-id=""><i class="fa fa-shopping-cart mr-1"></i> Add To
                Cart</button>
        </div>
        <div class="d-flex pt-2">
            <strong class="text-dark mr-2">Share on:</strong>
            <div class="d-inline-flex">
                <a class="text-dark px-2" href="">
                    <i class="fab fa-facebook-f"></i>
                </a>
                <a class="text-dark px-2" href="">
                    <i class="fab fa-twitter"></i>
                </a>
                <a class="text-dark px-2" href="">
                    <i class="fab fa-linkedin-in"></i>
                </a>
                <a class="text-dark px-2" href="">
                    <i class="fab fa-pinterest"></i>
                </a>
            </div>
        </div>
    </div>
</div>
{% endif %}

        </div>
        <div class="row px-xl-5">
            <div class="col">
                <div class="bg-light p-30">
                    <div class="nav nav-tabs mb-4">
                        <a class="nav-item nav-link text-dark active" data-toggle="tab" href="#tab-pane-1">Description</a>
                        <a class="nav-item nav-link text-dark" data-toggle="tab" href="#tab-pane-2">Information</a>
                        <a class="nav-item nav-link text-dark" data-toggle="tab" href="#tab-pane-3">Reviews (0)</a>
                    </div>
                    <div class="tab-content">
                        <div class="tab-pane fade show active" id="tab-pane-1">
                            <h4 class="mb-3">Product Description</h4>
                            <p>Eos no lorem eirmod diam diam, eos elitr et gubergren diam sea. Consetetur vero aliquyam invidunt duo dolores et duo sit. Vero diam ea vero et dolore rebum, dolor rebum eirmod consetetur invidunt sed sed et, lorem duo et eos elitr, sadipscing kasd ipsum rebum diam. Dolore diam stet rebum sed tempor kasd eirmod. Takimata kasd ipsum accusam sadipscing, eos dolores sit no ut diam consetetur duo justo est, sit sanctus diam tempor aliquyam eirmod nonumy rebum dolor accusam, ipsum kasd eos consetetur at sit rebum, diam kasd invidunt tempor lorem, ipsum lorem elitr sanctus eirmod takimata dolor ea invidunt.</p>
                            <p>Dolore magna est eirmod sanctus dolor, amet diam et eirmod et ipsum. Amet dolore tempor consetetur sed lorem dolor sit lorem tempor. Gubergren amet amet labore sadipscing clita clita diam clita. Sea amet et sed ipsum lorem elitr et, amet et labore voluptua sit rebum. Ea erat sed et diam takimata sed justo. Magna takimata justo et amet magna et.</p>
                        </div>
                        <div class="tab-pane fade" id="tab-pane-2">
                            <h4 class="mb-3">Additional Information</h4>
                            <p>Eos no lorem eirmod diam diam, eos elitr et gubergren diam sea. Consetetur vero aliquyam invidunt duo dolores et duo sit. Vero diam ea vero et dolore rebum, dolor rebum eirmod consetetur invidunt sed sed et, lorem duo et eos elitr, sadipscing kasd ipsum rebum diam. Dolore diam stet rebum sed tempor kasd eirmod. Takimata kasd ipsum accusam sadipscing, eos dolores sit no ut diam consetetur duo justo est, sit sanctus diam tempor aliquyam eirmod nonumy rebum dolor accusam, ipsum kasd eos consetetur at sit rebum, diam kasd invidunt tempor lorem, ipsum lorem elitr sanctus eirmod takimata dolor ea invidunt.</p>
                            <div class="row">
                                <div class="col-md-6">
                                    <ul class="list-group list-group-flush">
                                        <li class="list-group-item px-0">
                                            Sit erat duo lorem duo ea consetetur, et eirmod takimata.
                                        </li>
                                        <li class="list-group-item px-0">
                                            Amet kasd gubergren sit sanctus et lorem eos sadipscing at.
                                        </li>
                                        <li class="list-group-item px-0">
                                            Duo amet accusam eirmod nonumy stet et et stet eirmod.
                                        </li>
                                        <li class="list-group-item px-0">
                                            Takimata ea clita labore amet ipsum erat justo voluptua. Nonumy.
                                        </li>
                                      </ul> 
                                </div>
                                <div class="col-md-6">
                                    <ul class="list-group list-group-flush">
                                        <li class="list-group-item px-0">
                                            Sit erat duo lorem duo ea consetetur, et eirmod takimata.
                                        </li>
                                        <li class="list-group-item px-0">
                                            Amet kasd gubergren sit sanctus et lorem eos sadipscing at.
                                        </li>
                                        <li class="list-group-item px-0">
                                            Duo amet accusam eirmod nonumy stet et et stet eirmod.
                                        </li>
                                        <li class="list-group-item px-0">
                                            Takimata ea clita labore amet ipsum erat justo voluptua. Nonumy.
                                        </li>
                                      </ul> 
                                </div>
                            </div>
                        </div>
                        <div class="tab-pane fade" id="tab-pane-3">
                            <div class="row">
                                <div class="col-md-6">
                                    <h4 class="mb-4">1 review for "Product Name"</h4>
                                    <div class="media mb-4">
                                        <img src="img/user.jpg" alt="Image" class="img-fluid mr-3 mt-1" style="width: 45px;">
                                        <div class="media-body">
                                            <h6>John Doe<small> - <i>01 Jan 2045</i></small></h6>
                                            <div class="text-primary mb-2">
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star"></i>
                                                <i class="fas fa-star-half-alt"></i>
                                                <i class="far fa-star"></i>
                                            </div>
                                            <p>Diam amet duo labore stet elitr ea clita ipsum, tempor labore accusam ipsum et no at. Kasd diam tempor rebum magna dolores sed sed eirmod ipsum.</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <h4 class="mb-4">Leave a review</h4>
                                    <small>Your email address will not be published. Required fields are marked *</small>
                                    <div class="d-flex my-3">
                                        <p class="mb-0 mr-2">Your Rating * :</p>
                                        <div class="text-primary">
                                            <i class="far fa-star"></i>
                                            <i class="far fa-star"></i>
                                            <i class="far fa-star"></i>
                                            <i class="far fa-star"></i>
                                            <i class="far fa-star"></i>
                                        </div>
                                    </div>
                                    <form>
                                        <div class="form-group">
                                            <label for="message">Your Review *</label>
                                            <textarea id="message" cols="30" rows="5" class="form-control"></textarea>
                                        </div>
                                        <div class="form-group">
                                            <label for="name">Your Name *</label>
                                            <input type="text" class="form-control" id="name">
                                        </div>
                                        <div class="form-group">
                                            <label for="email">Your Email *</label>
                                            <input type="email" class="form-control" id="email">
                                        </div>
                                        <div class="form-group mb-0">
                                            <input type="submit" value="Leave Your Review" class="btn btn-primary px-3">
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Shop Detail End -->


    <!-- Products Start -->
    <div class="container-fluid py-5">
    <h2 class="section-title position-relative text-uppercase mx-xl-5 mb-4">
        <span class="bg-secondary pr-3">You May Also Like</span>
    </h2>
    <div class="row px-xl-5">
        {% if related %}
        {% for i in related %}
        <div class="col-lg-3 col-md-4 col-sm-6 mb-4">
            <div class="product-item bg-light">
                <div class="product-img position-relative overflow-hidden">
                    {% if i.images.all %}
                    <img class="img-fluid w-100" src="{{ i.images.first.image.url }}" alt="">
                    {% endif %}
                    <div class="product-action">
                        <a class="btn btn-outline-dark btn-square" href=""><i class="fa fa-shopping-cart"></i></a>
                        <a class="btn btn-outline-dark btn-square" href=""><i class="far fa-heart"></i></a>
                        <a class="btn btn-outline-dark btn-square" href=""><i class="fa fa-sync-alt"></i></a>
                        <a class="btn btn-outline-dark btn-square" href="{% url 'productDetails' i.id %}"><i class="fa fa-search"></i></a>
                    </div>
                </div>
                <div class="text-center py-4">
                    <a class="h6 text-decoration-none text-truncate" href="">{{ i.name }}</a>
                    <div class="d-flex align-items-center justify-content-center mt-2">
                        <h5>${{ i.price }}</h5>
                        <h6 class="text-muted ml-2"><del>${{ i.price }}</del></h6>
                    </div>
                    <div class="d-flex align-items-center justify-content-center mb-1">
                        <small class="fa fa-star text-primary mr-1"></small>
                        <small class="fa fa-star text-primary mr-1"></small>
                        <small class="fa fa-star text-primary mr-1"></small>
                        <small class="fa fa-star text-primary mr-1"></small>
                        <small class="fa fa-star text-primary mr-1"></small>
                        <small>(99)</small>
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
        {% endif %}
    </div>
</div>

    <!-- Products End -->


    <!-- Footer Start -->
    <div class="container-fluid bg-dark text-secondary mt-5 pt-5">
        <div class="row px-xl-5 pt-5">
            <div class="col-lg-4 col-md-12 mb-5 pr-3 pr-xl-5">
                <h5 class="text-secondary text-uppercase mb-4">Get In Touch</h5>
                <p class="mb-4">No dolore ipsum accusam no lorem. Invidunt sed clita kasd clita et et dolor sed dolor. Rebum tempor no vero est magna amet no</p>
                <p class="mb-2"><i class="fa fa-map-marker-alt text-primary mr-3"></i>123 Street, New York, USA</p>
                <p class="mb-2"><i class="fa fa-envelope text-primary mr-3"></i>info@example.com</p>
                <p class="mb-0"><i class="fa fa-phone-alt text-primary mr-3"></i>+012 345 67890</p>
            </div>
            <div class="col-lg-8 col-md-12">
                <div class="row">
                    <div class="col-md-4 mb-5">
                        <h5 class="text-secondary text-uppercase mb-4">Quick Shop</h5>
                        <div class="d-flex flex-column justify-content-start">
                            <a class="text-secondary mb-2" href="#"><i class="fa fa-angle-right mr-2"></i>Home</a>
                            <a class="text-secondary mb-2" href="#"><i class="fa fa-angle-right mr-2"></i>Our Shop</a>
                            <a class="text-secondary mb-2" href="#"><i class="fa fa-angle-right mr-2"></i>Shop Detail</a>
                            <a class="text-secondary mb-2" href="#"><i class="fa fa-angle-right mr-2"></i>Shopping Cart</a>
                            <a class="text-secondary mb-2" href="#"><i class="fa fa-angle-right mr-2"></i>Checkout</a>
                            <a class="text-secondary" href="#"><i class="fa fa-angle-right mr-2"></i>Contact Us</a>
                        </div>
                    </div>
                    <div class="col-md-4 mb-5">
                        <h5 class="text-secondary text-uppercase mb-4">My Account</h5>
                        <div class="d-flex flex-column justify-content-start">
                            <a class="text-secondary mb-2" href="#"><i class="fa fa-angle-right mr-2"></i>Home</a>
                            <a class="text-secondary mb-2" href="#"><i class="fa fa-angle-right mr-2"></i>Our Shop</a>
                            <a class="text-secondary mb-2" href="#"><i class="fa fa-angle-right mr-2"></i>Shop Detail</a>
                            <a class="text-secondary mb-2" href="#"><i class="fa fa-angle-right mr-2"></i>Shopping Cart</a>
                            <a class="text-secondary mb-2" href="#"><i class="fa fa-angle-right mr-2"></i>Checkout</a>
                            <a class="text-secondary" href="#"><i class="fa fa-angle-right mr-2"></i>Contact Us</a>
                        </div>
                    </div>
                    <div class="col-md-4 mb-5">
                        <h5 class="text-secondary text-uppercase mb-4">Newsletter</h5>
                        <p>Duo stet tempor ipsum sit amet magna ipsum tempor est</p>
                        <form action="">
                            <div class="input-group">
                                <input type="text" class="form-control" placeholder="Your Email Address">
                                <div class="input-group-append">
                                    <button class="btn btn-primary">Sign Up</button>
                                </div>
                            </div>
                        </form>
                        <h6 class="text-secondary text-uppercase mt-4 mb-3">Follow Us</h6>
                        <div class="d-flex">
                            <a class="btn btn-primary btn-square mr-2" href="#"><i class="fab fa-twitter"></i></a>
                            <a class="btn btn-primary btn-square mr-2" href="#"><i class="fab fa-facebook-f"></i></a>
                            <a class="btn btn-primary btn-square mr-2" href="#"><i class="fab fa-linkedin-in"></i></a>
                            <a class="btn btn-primary btn-square" href="#"><i class="fab fa-instagram"></i></a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row border-top mx-xl-5 py-4" style="border-color: rgba(256, 256, 256, .1) !important;">
            <div class="col-md-6 px-xl-0">
                <p class="mb-md-0 text-center text-md-left text-secondary">
                    &copy; <a class="text-primary" href="#">Domain</a>. All Rights Reserved. Designed
                    by
                    <a class="text-primary" href="https://htmlcodex.com">HTML Codex</a>
                    <br>Distributed By: <a href="https://themewagon.com" target="_blank">ThemeWagon</a>
                </p>
            </div>
            <div class="col-md-6 px-xl-0 text-center text-md-right">
                <img class="img-fluid" src="img/payments.png" alt="">
            </div>
        </div>
    </div>
    <!-- Footer End -->


    <!-- Back to Top -->
    <a href="#" class="btn btn-primary back-to-top"><i class="fa fa-angle-double-up"></i></a>


    <!-- JavaScript Libraries -->
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.bundle.min.js"></script>
    <script src="lib/easing/easing.min.js"></script>
    <script src="lib/owlcarousel/owl.carousel.min.js"></script>

    <!-- Contact Javascript File -->
    <script src="mail/jqBootstrapValidation.min.js"></script>
    <script src="mail/contact.js"></script>

    <!-- Template Javascript -->
    <!-- <script src="{% static 'user_js/home_script.js' %}"></script> -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>

    <script>
   $(".magnified").hover(function(e) {
    var magnifierWidth = $(".magnifier").outerWidth(),
        magnifierHeight = $(".magnifier").outerHeight(),
        posX = e.pageX - magnifierWidth / 2 + 100, // Increase 100px from left
        posY = e.pageY - magnifierHeight / 2 - 100; // Decrease 100px from top

    $(".magnifier").css({
        top: posY + "px",
        left: posX + "px"
    }).show();

    $(this).mousemove(function(e) {
        var parentOffset = $(this).offset(),
            relativeX = (e.pageX - parentOffset.left) / $(this).outerWidth(),
            relativeY = (e.pageY - parentOffset.top) / $(this).outerHeight();

        $(".magnifier").css({
            top: e.pageY - magnifierHeight / 2 - 100 + "px", // Adjusted position from top
            left: e.pageX - magnifierWidth / 2 + 100 + "px", // Adjusted position from left
            backgroundPosition: (relativeX * 100) + "% " + (relativeY * 100) + "%"
        });
    });
}, function() {
    $(".magnifier").hide();
});


document.addEventListener('DOMContentLoaded', function() {
    const configurations = {{ configurations|safe }};
    
    function getSelectedOptions() {
        let selectedOptions = [];
        document.querySelectorAll('input.variation-option:checked').forEach(input => {
            selectedOptions.push(parseInt(input.value));
        });
        return selectedOptions;
    }

    function findMatchingConfiguration(selectedOptions) {
        return configurations.find(config => {
            return selectedOptions.every(optionId => config.options.includes(optionId));
        });
    }

    function getSelectedVariationDetails() {
        let variationDetails = [];
        document.querySelectorAll('input.variation-option:checked').forEach(input => {
            let variationName = input.getAttribute('data-variation-name');
            let optionValue = input.getAttribute('data-option-value');
            variationDetails.push(`${variationName}: ${optionValue}`);
        });
        return variationDetails.join(', ');
    }

    function updatePriceAndStock() {
        const selectedOptions = getSelectedOptions();
        const matchingConfig = findMatchingConfiguration(selectedOptions);
        const variationDetails = getSelectedVariationDetails();

        if (matchingConfig) {
            document.getElementById('product-price').textContent = '$' + matchingConfig.price;
            document.getElementById('stock-info').textContent = `${variationDetails} (${matchingConfig.qty_in_stock} stock remains)`;
        } else {
            document.getElementById('product-price').textContent = 'N/A';
            document.getElementById('stock-info').textContent = `${variationDetails} (Out of stock)`;
        }
    }

    document.querySelectorAll('input.variation-option').forEach(input => {
        input.addEventListener('change', updatePriceAndStock);
    });

    updatePriceAndStock(); // Initial call to set the price and stock based on the default selections
});

      </script>
<!-- JavaScript for adding to cart -->
<!-- JavaScript for adding to cart -->
<script>
document.addEventListener('DOMContentLoaded', function () {
    document.querySelectorAll('.add-to-cart-btn').forEach(button => {
        button.addEventListener('click', function (e) {
            e.preventDefault();

            const productId = this.getAttribute('data-product-id');
            console.log('Product ID:', productId);

            if (productId) {
                const parentElement = this.closest('.d-flex.align-items-center.mb-4.pt-2');
                if (parentElement) {
                    const quantityInput = parentElement.querySelector('.form-control');
                    if (quantityInput) {
                        const quantity = quantityInput.value;
                        console.log('Quantity:', quantity);

                        // Collect selected options
                        const selectedOptions = [];
                        document.querySelectorAll('.variation-option:checked').forEach(option => {
                            selectedOptions.push(option.value);
                        });
                        console.log('Selected Options:', selectedOptions);

                        // Fetch the configuration ID based on selected options
                        fetch("/get_configuration_id/", {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                                'X-CSRFToken': '{{ csrf_token }}'  // Ensure CSRF token is included
                            },
                            body: JSON.stringify({
                                product_id: productId,
                                selected_options: selectedOptions
                            })
                        })
                        .then(response => {
                            if (!response.ok) {
                                throw new Error('Network response was not ok');
                            }
                            return response.json();
                        })
                        .then(data => {
                            if (data.success) {
                                const configurationId = data.configuration_id;
                                console.log('Configuration ID:', configurationId);

                                // Now make the add to cart request
                                fetch("/add_to_cart/", {
                                    method: 'POST',
                                    headers: {
                                        'Content-Type': 'application/json',
                                        'X-CSRFToken': '{{ csrf_token }}'  // Ensure CSRF token is included
                                    },
                                    body: JSON.stringify({
                                        product_id: productId,
                                        configuration_id: configurationId,
                                        quantity: quantity
                                    })
                                })
                                .then(response => {
                                    if (!response.ok) {
                                        throw new Error('Network response was not ok');
                                    }
                                    return response.json();
                                })
                                .then(data => {
                                    if (data.success) {
                                        alert('Product added to cart successfully!');
                                    } else {
                                        alert('Failed to add product to cart. Please try again.');
                                    }
                                })
                                .catch(error => {
                                    console.error('Error adding product to cart:', error);
                                    alert('Failed to add product to cart. Please try again.');
                                });
                            } else {
                                alert('Failed to fetch product configuration. Please try again.');
                            }
                        })
                        .catch(error => {
                            console.error('Error fetching configuration ID:', error);
                            alert('Failed to fetch product configuration. Please try again.');
                        });
                    } else {
                        console.error('Form control input not found');
                        alert('Quantity input not found. Please try again.');
                    }
                } else {
                    console.error('Parent element not found');
                    alert('Parent element not found. Please try again.');
                }
            } else {
                console.error('Product ID not found');
                alert('Product ID not found. Please try again.');
            }
        });
    });
});

</script>



</body>

</html>